<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
  <style>
    body {
      margin: 0;
      padding: 0;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      min-height: 100vh;
      overflow: hidden;
    }

    #uploadSection {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      background-color: rgba(0, 0, 0, 0.8);
    }

    #uploadSection h1 {
      color: white;
      font-family: Arial, Helvetica, sans-serif;
      margin-bottom: 20px;
    }

    #uploadSection input[type="file"] {
      padding: 10px;
      font-size: 16px;
      margin-bottom: 10px;
    }

    #uploadButton {
      padding: 10px 30px;
      font-size: 18px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    #uploadButton:hover {
      background-color: #45a049;
    }

    #typingSection {
      display: none;
      height: 100vh;
      position: relative;
      overflow: hidden;
    }

    #inputContainer {
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 1000;
    }

    #input {
      font-size: 16px;
      padding: 8px;
      width: 400px;
      border: 2px solid #ccc;
      border-radius: 5px;
    }

    #outputContainer {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 80px 40px 40px 40px;
      box-sizing: border-box;
    }

    #output {
      font-family: Arial, Helvetica, sans-serif;
      text-align: center;
      font-weight: bold;
      color: yellow;
      transition: opacity 1s;
      word-wrap: break-word;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
      max-width: 100%;
      max-height: 100%;
      overflow: hidden;
      line-height: 1.2;
    }
  </style>
</head>
<body>
  <!-- Upload Section -->
  <div id="uploadSection">
    <h1>Upload a Background Image</h1>
    <input type="file" id="fileInput" accept="image/*">
    <button id="uploadButton">Continue</button>
  </div>

  <!-- Typing Section (hidden initially) -->
  <div id="typingSection">
    <div id="inputContainer">
      <input id="input" type="text" placeholder="Type something here">
    </div>
    <div id="outputContainer">
      <div id="output" style="opacity: 1;">Start typing here!</div>
    </div>
  </div>

  <script>
    // Upload functionality
    const uploadSection = document.getElementById("uploadSection");
    const typingSection = document.getElementById("typingSection");
    const fileInput = document.getElementById("fileInput");
    const uploadButton = document.getElementById("uploadButton");

    uploadButton.addEventListener("click", function() {
      const file = fileInput.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          document.body.style.backgroundImage = `url(${e.target.result})`;
          uploadSection.style.display = "none";
          typingSection.style.display = "block";
          adjustFontSize(); // Initial font size adjustment
        };
        reader.readAsDataURL(file);
      } else {
        alert("Please select an image first!");
      }
    });

    // Get the input and output elements
    let input = document.getElementById("input");
    let output = document.getElementById("output");
    let outputContainer = document.getElementById("outputContainer");
    let intervalID;

    // Function to calculate and set the appropriate font size
    function adjustFontSize() {
      const text = output.textContent;
      const containerWidth = outputContainer.clientWidth;
      const containerHeight = outputContainer.clientHeight;
      
      // Start with a base font size (in pixels, roughly equivalent to 12pt)
      let fontSize = 16;
      
      // If there's text, calculate the optimal size
      if (text.length > 0) {
        // Create a temporary element to measure text dimensions
        const temp = document.createElement('div');
        temp.style.position = 'absolute';
        temp.style.visibility = 'hidden';
        temp.style.fontFamily = output.style.fontFamily || 'Arial, Helvetica, sans-serif';
        temp.style.fontWeight = 'bold';
        temp.style.lineHeight = '1.2';
        temp.style.wordWrap = 'break-word';
        temp.style.whiteSpace = 'normal';
        temp.textContent = text;
        document.body.appendChild(temp);
        
        // Start with a reasonable maximum font size
        let maxFontSize = Math.min(containerHeight * 0.8, 200);
        let minFontSize = 16; // Minimum readable size (12pt)
        
        // Binary search for the optimal font size
        while (maxFontSize - minFontSize > 1) {
          fontSize = Math.floor((maxFontSize + minFontSize) / 2);
          temp.style.fontSize = fontSize + 'px';
          temp.style.maxWidth = containerWidth + 'px';
          
          if (temp.scrollHeight <= containerHeight && temp.scrollWidth <= containerWidth) {
            minFontSize = fontSize;
          } else {
            maxFontSize = fontSize;
          }
        }
        
        fontSize = minFontSize;
        document.body.removeChild(temp);
      } else {
        // For empty or very short text, use a larger readable size
        fontSize = Math.min(containerHeight * 0.3, 72);
      }
      
      output.style.fontSize = fontSize + 'px';
    }

    function checknewText() {
      if (input.value !== output.textContent) {
        output.style.opacity = 0;
        let text = input.value;

        setTimeout(function() {
          output.textContent = text;
          adjustFontSize(); // Adjust font size based on new text
        }, 300);

        setTimeout(function() {
          output.style.opacity = 1;
        }, 300);
      }
    }

    intervalID = setInterval(checknewText, 1000);

    input.addEventListener("keyup", function() {
      let text = input.value;
    });

    // Adjust font size when window is resized
    window.addEventListener('resize', function() {
      adjustFontSize();
    });

    window.addEventListener('load', function() {
      adjustFontSize();
    });
  </script>
</body>
</html>